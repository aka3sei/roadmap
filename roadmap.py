import streamlit as st

# ページ設定
st.set_page_config(page_title="不動産取引・プロフェッショナルガイド", layout="wide")

st.title("🗺️ 不動産取引・完全網羅詳細ロードマップ")
st.write("各工程の深掘り解説。実務で直面する「リアルなポイント」をすべてまとめました。")

tab_sell, tab_buy = st.tabs(["🏠 売却の全工程（詳細版）", "🔑 購入の全工程（詳細版）"])

# ==========================================
# 🏠 売却セクションの超詳細
# ==========================================
with tab_sell:
    sell_steps = ["1.売買相談", "2.物件調査", "3.査定", "4.媒介契約", "5.インスペクション", "6.広告・売却活動", "7.契約交渉", "8.重要事項説明", "9.引渡・登記・決済"]
    
    sell_details = {
        "1.売買相談": {
            "内容": "売却の目的（住み替え、相続、資産整理）を整理し、スケジュールを逆算します。単に売るだけでなく、税金対策や買い替え先の確保を含めたトータルデザインを行います。",
            "アクション": "・売却希望時期の確定\n・残債の確認（住宅ローン一括返済の可否）\n・住み替え先の内定（先行購入か先行売却か）",
            "重要ポイント": "「なぜ売るのか」によって戦略が変わります。例えば買い替えなら『いつまでに現金化が必要か』が最優先事項となります。"
        },
        "2.物件調査": {
            "内容": "公図・謄本での権利関係確認、道路の接道状況、上下水道の埋設管、都市計画法や建築基準法の制限を網羅的に調べます。",
            "アクション": "・法務局での謄本取得\n・役所での道路、都市計画調査\n・現地の境界標の確認（紛失していないか）",
            "重要ポイント": "境界不明や越境（隣家の枝がはみ出している等）が後で発覚すると、契約解除の原因になります。初期調査が命です。"
        },
        "3.査定": {
            "内容": "過去1年の近隣成約事例、地価公示、現在の競合物件を比較分析。建物のメンテナンス状況（外壁塗装、内装リフォーム履歴）を価格に反映させます。",
            "アクション": "・机上査定（データ分析）\n・訪問査定（建物の個別状態確認）\n・リフォーム履歴一覧の作成",
            "重要ポイント": "高い査定額を出す会社が良い会社とは限りません。『なぜその価格で売れるのか』という論理的な根拠を重視してください。"
        },
        "4.媒介契約": {
            "内容": "売却活動を依頼する法的契約です。「専属専任」「専任」「一般」の3形態から選び、販売方針を決定します。",
            "アクション": "・媒介契約書の締結\n・販売図面作成用のヒアリングへの回答\n・鍵の預け入れ（空家の場合）",
            "重要ポイント": "囲い込み（他社に客付けさせない行為）を防ぐため、レインズ（指定流通機構）への登録証明書を必ず確認しましょう。"
        },
        "5.インスペクション": {
            "内容": "既存住宅状況調査技術者の資格を持つ建築士が、建物の構造耐力主要部や雨水の浸入を防止する部分を検査します。",
            "アクション": "・専門業者の手配\n・床下、屋根裏、外壁のクラック確認\n・報告書の受領",
            "重要ポイント": "事前に欠陥を知ることで、売主の『契約不適合責任（旧：瑕疵担保責任）』のリスクを劇的に下げ、買主の安心感を高められます。"
        },
        "6.広告・売却活動": {
            "内容": "SUUMOやホームズへの掲載に加え、プロカメラマンによる撮影、VRツアーの作成、オープンハウスの開催など、露出を最大化します。",
            "アクション": "・写真撮影前のハウスクリーニング、片付け\n・内覧希望者への対応、お茶出し検討\n・週次・月次での反響数チェック",
            "重要ポイント": "内覧時の第一印象は「香り」と「明るさ」で決まります。全居室の照明を点け、換気を徹底しましょう。"
        },
        "7.契約交渉": {
            "内容": "購入希望者から届く「買付証明書」に対し、価格だけでなく、引渡し時期、付帯設備（エアコンを残すか等）を調整します。",
            "アクション": "・購入希望者の属性（ローン利用か現金か）確認\n・条件交渉（指値への回答）\n・契約日の決定",
            "重要ポイント": "満額回答でも『ローン特約』の期間が長い場合は注意が必要です。確実性の高い買主を見極める必要があります。"
        },
        "8.重要事項説明": {
            "内容": "宅建士が買主へ物件の全て（リスク含む）を説明します。売主も内容に相違がないか、告知事項に漏れがないか最終チェックを行います。",
            "アクション": "・告知事項（事故歴、近隣トラブル、雨漏り等）の最終確認\n・付帯設備表、物件状況報告書の作成",
            "重要ポイント": "『知っているのに言わなかった』ことが後で判明するのが最大のリスクです。どんな些細な不具合も正直に共有しましょう。"
        },
        "9.引渡・登記・決済": {
            "内容": "司法書士立ち会いのもと、残代金を受領。固定資産税の精算を行い、管理費等の清算、鍵の引き渡し、登記申請を同時に行います。",
            "アクション": "・実印、印鑑証明書、権利証の準備\n・残債の完済手続き（銀行窓口）\n・管理費等の日割り精算",
            "重要ポイント": "この日の数日前に、物件が『空の状態』であることを確認します。残置物（ゴミなど）があると引渡しができません。"
        }
    }

    current_sell = st.select_slider("売却工程を選択", options=sell_steps, key="s_pro")
    
    st.markdown(f"## 🏁 {current_sell}")
    s_col1, s_col2 = st.columns(2)
    with s_col1:
        st.info(f"#### 📝 実務内容とアクション\n{sell_details[current_sell]['内容']}\n\n**【具体的なタスク】**\n{sell_details[current_sell]['アクション']}")
    with s_col2:
        st.success(f"#### 💡 プロフェッショナル・ポイント\n{sell_details[current_sell]['重要ポイント']}")

    st.progress((sell_steps.index(current_sell) + 1) / len(sell_steps))
    

# ==========================================
# 🔑 購入セクションの超詳細
# ==========================================
with tab_buy:
    buy_steps = ["1.購入相談", "2.資金計画", "3.物件調査", "4.購入申込", "5.契約交渉", "6.媒介契約", "7.重要事項説明", "8.売買契約締結", "9.住宅ローン審査", "10.引渡・登記・決済"]
    
    buy_details = {
        "1.購入相談": {
            "内容": "単なる広さや価格だけでなく、ライフスタイル（通勤、子育て環境、将来の売却可能性）に基づいた条件設定を行います。",
            "アクション": "・希望エリアの優先順位付け\n・最低限必要なスペックの書き出し\n・将来のライフイベントの整理",
            "ポイント": "『絶対に譲れない条件』を絞りすぎないことがコツです。80点満点の物件があれば即買いの姿勢が重要です。"
        },
        "2.資金計画": {
            "内容": "年収から算出する『借りられる額』ではなく、生活費から逆算する『返せる額』を算出。諸費用（物件価格の約7〜10%）を正確に把握します。",
            "アクション": "・金融機関での事前審査（必須）\n・諸費用（仲介手数料、登記費用、印紙代）の内訳確認\n・ペアローン、合算の検討",
            "ポイント": "事前審査を通していないと、人気物件では土俵にも乗れません。内覧前に必ず済ませましょう。"
        },
        "3.物件調査": {
            "内容": "内見に加え、マンションなら『重要事項調査報告書』で積立金の不足や修繕計画を確認。戸建
